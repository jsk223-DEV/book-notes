<%- include('partials/header.ejs') %>
<main>
	<% if(locals.book) { %>
	<h2 id="book_title"><%= book.title %></h2>
	<p id="authors"><%= book.authors.toString().replaceAll(',', ', ') %></p>
	<p id="description"><%= book.description %></p>

	<form id="new_book_form" action="/save-book" method="POST">
		<input type="hidden" name="title" value="<%= book.title %>" />
		<input
			type="hidden"
			name="author"
			value="<%= book.authors.toString().replaceAll(',', ', ') %>" />
		<% for(let i = 0; i < book.covers.length; i++) {%> <% if(i > 5) { break }%>
		<label for="cover_<%= book.covers[i] %>">
			<img
				class="cover-option"
				src="https://covers.openlibrary.org/b/id/<%= book.covers[i] %>-M.jpg" />
		</label>
		<input
			type="radio"
			id="cover_<%= book.covers[i] %>"
			value="<%= book.covers[i] %>"
			name="cover"
			style="display: none" />
		<% } %>
		<input
			type="text"
			id="genre"
			name="genre"
			value=""
			list="genreSuggestions"
			autocomplete="none" />
		<% if(book.suggestedGenres.length > 0) { %>
		<datalist id="genreSuggestions">
			<%book.suggestedGenres.forEach(gen => {%>

			<option value="<%= gen %>"></option>
			<% }) %>
		</datalist>

		<% } %>
		<textarea id="review" placeholder="Review this book" name="review"></textarea>
		<% for(let i = 1; i < 6; i++){ %>
		<input
			class="rating-radio"
			type="radio"
			name="rating"
			value="<%= i %>"
			id="rating_<%= i %>"
			style="display: none" />
		<label for="rating_<%= i %>"
			><svg
				xmlns="http://www.w3.org/2000/svg"
				width="15"
				height="15"
				viewBox="0 0 24 24"
				fill="none"
				stroke="white"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round"
				class="lucide lucide-star-icon lucide-star">
				<path
					d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z" /></svg
		></label>
		<% } %>
		<label for="tr_r">To Read: </label>
		<input type="radio" name="status" value="to read" id="tr_r" checked />
		<label for="rn_r">Reading Now: </label>
		<input type="radio" name="status" value="reading now" id="rn_r" />
		<label for="hr_r">Have Read: </label>
		<input type="radio" name="status" value="have read" id="hr_r" />
		<input type="submit" value="Save" />
		<input type="button" onclick="goBack()" value="Cancel" />
	</form>
	<% } %>
</main>
<script>
	function goBack() {
		if (window.history.length > 1) {
			window.history.back();
		} else {
			window.location.href = '/';
		}
	}
</script>
<%- include('partials/footer.ejs') %>
