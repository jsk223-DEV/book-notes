<%- include('partials/header.ejs') %>
<main>
	<div id="filter_order">
		<div class="filter-bar">
			Filter:
			<a href="/?filter=all" class="<%= locals.filter && filter == 'all' ? 'active' : '' %>"
				>All</a
			>
			<a
				href="/?filter=to read"
				class="<%= locals.filter && filter == 'to read' ? 'active' : '' %>"
				>To Read</a
			><a
				href="/?filter=reading now"
				class="<%= locals.filter && filter == 'reading now' ? 'active' : '' %>"
				>Reading Now</a
			><a
				href="/?filter=have read"
				class="<%= locals.filter && filter == 'have read' ? 'active' : '' %>"
				>Have Read</a
			>
		</div>
		<div class="order-bar">
			Order By:
			<a
				href="/?order=id DESC"
				class="<%= locals.order && order == 'id DESC' ? 'active' : '' %>"
				>Newest</a
			>
			<a
				href="/?order=rating DESC"
				class="<%= locals.order && order == 'rating DESC' ? 'active' : '' %>"
				>Rating</a
			><a
				href="/?order=author ASC"
				class="<%= locals.order && order == 'author ASC' ? 'active' : '' %>"
				>Author</a
			>
			<a
				href="/?order=title ASC"
				class="<%= locals.order && order == 'title ASC' ? 'active' : '' %>"
				>Title</a
			>
		</div>
	</div>
	<div id="saved_books">
		<% if (locals.books && books.length > 0) {%> <%books.forEach(book => {%>
		<div class="saved-book">
			<% if(book.cover_id){%>
			<img
				class="sb-cover"
				src="https://covers.openlibrary.org/b/id/<%= book.cover_id %>-M.jpg"
			/>
			<% }else{ %>
			<img class="sb-cover" src="/images/noBookCover.jpg" />
			<% } %>
			<div class="sb-info">
				<div class="sb-title-author">
					<% if(book.title) { %>
					<p class="sb-title"><%= book.title %></p>
					<% } %> <% if(book.author) { %>
					<p class="sb-author">By: <%= book.author %></p>
					<% } %>
				</div>
				<!-- <%# if(book.date_added) { %>
				<p class="sb-date">Date Added: <%# book.date_added %></p>
				<%# } %>  -->
				<div class="sb-scale-info">
					<% if(book.status) { %>
					<p class="sb-status-con">
						Status:
						<a
							href="/update-status?id=<%= book.id  %>"
							class="sb-status <%= book.status.split(' ')[0] %>"
							><%= book.status %></a
						>
					</p>
					<% } %> <% if(book.genre) { %>
					<p class="sb-genre">Genre: <%= book.genre %></p>
					<% } %> <% if(book.rating) { %>
					<p class="sb-rating">
						Rating: <% for(let i = 1; i < 6; i++) {%>
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="15"
							height="15"
							viewBox="0 0 24 24"
							fill="<%= i <= book.rating ? 'yellow' : 'none' %>"
							stroke="white"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							class="lucide lucide-star-icon lucide-star"
						>
							<path
								d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"
							/>
						</svg>

						<% } %>
					</p>
					<% } %> <% if(book.review) { %>
					<p class="sb-review">
						Review: <%= book.review.length > 45 ? book.review.slice(0, 45).concat('...')
						: book.review %>
					</p>
					<% } %>
				</div>
				<div class="sb-buttons">
					<a class="sb-info" href="/edit-book?id=<%= book.id %>">Edit</a>
					<a
						class="sb-delete"
						onclick="if(confirm(`Are you sure you want to delete <%= book.title %>?`)){window.location.href = '/delete-book?id=<%= book.id %>'}"
						href="javascript:void(0)"
						>Delete</a
					>
				</div>
			</div>
		</div>
		<% }) %> <% } else { %>
		<div>This bookshelf is looking a little empty.</div>
		<% } %>
	</div>
</main>
<%- include('partials/footer.ejs') %>
